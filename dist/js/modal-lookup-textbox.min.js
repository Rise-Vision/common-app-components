!function(){"use strict";angular.module("risevision.app.common.components.modal-lookup-textbox",["risevision.common.loading","ui.bootstrap"])}(),function(){"use strict";angular.module("risevision.app.common.components.modal-lookup-textbox").controller("tagLookup",["$scope","tag","$modalInstance","$loading","$log","tags",function(t,a,n,o,e,l){var s="LOOKUP";t.loadingTags=!1,t.selectedTags=l?l:[],t.$watch("loadingTags",function(t){t?o.start("tag-loader"):o.stop("tag-loader")});var i=function(t){for(var a=[],n=0;n<t.length;n++){var o=t[n];if(o.type===s)for(var e=0;e<o.values.length;e++)a.push({name:o.name,value:o.values[e]})}return a},c=function(){t.loadingTags=!0,a.list().then(function(t){return t.items}).then(function(a){t.availableTags=i(a)}).then(null,function(t){e.error("Could not load tags: ",t)}).finally(function(){t.loadingTags=!1})};c(),t.selectTag=function(a){t.selectedTags.push(a)},t.removeTag=function(a){a>-1&&t.selectedTags.splice(a,1)},t.cancel=function(){n.dismiss()},t.apply=function(){n.close(t.selectedTags)}}])}(),function(){"use strict";angular.module("risevision.app.common.components.modal-lookup-textbox").filter("tagSelection",[function(){return function(t,a){if(!t)return[];for(var n=[],o=0;o<t.length;o++){for(var e=!1,l=0;l<a.length;l++)if(t[o].name===a[l].name&&t[o].value===a[l].value){e=!0;break}e||n.push(t[o])}return n}}])}(),function(){"use strict";angular.module("risevision.app.common.components.modal-lookup-textbox").directive("tagTextbox",["$modal","$templateCache","$q",function(t,a,n){return{restrict:"E",$scope:{tags:"=?",tagDefs:"=",statusCode:"@"},template:a.get("modal-lookup-textbox/tag-textbox.html"),link:function(o){o.openModal=function(){var e=t.open({template:a.get("modal-lookup-textbox/tag-lookup-modal.html"),controller:"tagLookup",resolve:{tags:function(){return angular.copy(o.tags)},tag:function(){var t={};return t.list=function(){var t=n.defer();if(200===o.statusCode){var a={};a.items=o.tagDefs,t.resolve(a)}else t.reject("Rejection Status Code: "+o.statusCode);return t.promise},t}}});e.result.then(function(t){o.tags=t},function(){})}}}}])}(),function(){try{app=angular.module("risevision.app.common.components.modal-lookup-textbox")}catch(t){app=angular.module("risevision.app.common.components.modal-lookup-textbox",[])}app.run(["$templateCache",function(t){"use strict";t.put("modal-lookup-textbox/tag-lookup-modal.html",'<div>\n\n    <div class="modal-body">\n        <div rv-spinner rv-spinner-key="tag-loader" rv-spinner-start-active="0"></div>\n        <div class="content-box content-box-editable">\n            <div class="label label-tag" ng-repeat="tag in selectedTags" ng-click="removeTag($index)">\n                {{tag.name}}: <span class="tag-value">{{tag.value}}</span>\n                <span><i class="fa fa-minus-circle"></i></span>\n            </div>\n        </div>\n\n        <div class="content-box select-tags half-top">\n            <div class="input-group">\n                <span class="input-group-addon"><i class="fa fa-search"></i></span>\n                <input type="text" class="form-control" placeholder="Search Lookup Tags" ng-model="query">\n            </div>\n\n            <div class="label label-tag" ng-repeat="tag in availableTags | tagSelection:selectedTags | filter:query" ng-click="selectTag(tag)">\n                {{tag.name}}: <span class="tag-value">{{tag.value}}</span>\n                <span><i class="fa fa-plus-circle"></i></span>\n            </div>\n        </div>\n\n    </div><!-- modal-body -->\n\n    <div class="modal-footer">\n        <button type="button" class="btn btn-primary btn-fixed-width"  ng-click="apply()">Apply <i class="fa fa-white fa-check icon-right"></i></button>\n        <button type="button" class="btn btn-default btn-fixed-width" ng-click="cancel()">Cancel <i class="fa fa-times icon-right"></i></button>\n    </div>\n\n\n</div><!-- end: controller --> ')}])}(),function(){try{app=angular.module("risevision.app.common.components.modal-lookup-textbox")}catch(t){app=angular.module("risevision.app.common.components.modal-lookup-textbox",[])}app.run(["$templateCache",function(t){"use strict";t.put("modal-lookup-textbox/tag-textbox.html",'<div class="content-box content-box-editable clickable add-bottom" ng-click="openModal()">\n    <span class="edit-icon"><i class="fa fa-lg fa-pencil"></i></span>\n    <div class="label label-tag" ng-repeat="tag in tags">\n        <span class="tag-name">{{tag.name}}</span> <span class="tag-value">{{tag.value}}</span>\n    </div>\n</div>')}])}();